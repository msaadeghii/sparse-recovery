function [ w_n ] = lmbw0( x )
%exp(x./exp(x./exp(x
x = (x < -exp(-1)) .* (-exp(-1)) + (x >= -exp(-1)) .* x;
x2 = x .* x;
x3 = x2 .* x;
x4 = x3 .* x;
w_n = x  .* (1 + 5.931375839364438 * x + 11.39220550532913 * x2 + 7.33888339911111 * x3 + 0.653449016991959 * x4);
w_n = w_n ./ (1 + 6.931373689597704 * x + 16.82349461388016 * x2 + 16.43072324143226 * x3 + 5.115235195211697 * x4);
for i = 1:2
    z_n = log(x./w_n) - w_n;
    q_n = 2 * (1+w_n) .* (1+w_n+2/3 * z_n);
    e_n = (z_n ./ (1+w_n)) .* (q_n-z_n) ./ (q_n - 2*z_n);

    w_n = w_n .* (1 + e_n);
end
w_n = (x>-exp(-1)).* w_n;
w_n(x == 0) = 0;

end

